<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CorregePtx‚Ñ¢ ‚Äî Plataforma de Corre√ß√£o</title>

<!-- Fonte Google Inter -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />

<style>
  :root {
    /* Temas */
    --cor-escuro-fundo: #121212;
    --cor-escuro-texto: #e0e0e0;
    --cor-claro-fundo: #fefefe;
    --cor-claro-texto: #222222;
    --cor-pastel-fundo: #dd6b0879;
    --cor-pastel-texto: #5c4a3e;

    /* Cores gerais */
    --cor-primaria: #00caff;
    --cor-primaria-hover: #009ec3;
    --cor-botao-texto: #000;

    /* Borda e sombras */
    --raio-borda: 10px;
    --sombra-card: 0 6px 15px rgba(0, 0, 0, 0.3);

    /* Fontes */
    --fonte-principal: 'Inter', sans-serif;
  }

  /* Reset e base */
  *, *::before, *::after {
    box-sizing: border-box;
  }

  body {
    margin: 0;
    font-family: var(--fonte-principal);
    font-size: 1rem;
    background-color: var(--cor-escuro-fundo);
    color: var(--cor-escuro-texto);
    transition: background-color 0.3s ease, color 0.3s ease;
    min-height: 100vh;
    padding: 20px 15px;
  }

  /* Temas */
  body.tema-claro {
    background-color: var(--cor-claro-fundo);
    color: var(--cor-claro-texto);
  }

  body.tema-pastel {
    background-color: var(--cor-pastel-fundo);
    color: var(--cor-pastel-texto);
  }

  /* T√≠tulo e subt√≠tulo */
  h1 {
    text-align: center;
    color: var(--cor-primaria);
    font-weight: 600;
    margin-bottom: 0.1rem;
    user-select: none;
    text-shadow: 0 0 6px var(--cor-primaria);
  }

  p.subtitulo {
    text-align: center;
    font-style: italic;
    margin-top: 0;
    margin-bottom: 1.5rem;
    opacity: 0.7;
  }

  /* Container central */
  main {
    max-width: 900px;
    margin: 0 auto;
  }

  /* Se√ß√µes e cards */
  section {
    background-color: #222;
    padding: 1.2rem 1.6rem;
    border-radius: var(--raio-borda);
    box-shadow: var(--sombra-card);
    margin-bottom: 1.8rem;
    transition: background-color 0.3s ease, color 0.3s ease;
  }
  body.tema-claro section {
    background-color: #fff;
    color: var(--cor-claro-texto);
    box-shadow: 0 8px 22px rgba(0,0,0,0.1);
  }
  body.tema-pastel section {
    background-color: hsla(155, 79%, 55%, 0.411);
    color: var(--cor-pastel-texto);
    box-shadow: 0 8px 22px rgba(0,0,0,0.07);
  }

  /* Inputs, selects, textarea */
  input[type="text"], input[type="number"], select, textarea {
    width: 100%;
    padding: 0.55rem 0.8rem;
    border-radius: 7px;
    border: 1.8px solid #444;
    background-color: transparent;
    color: inherit;
    font-size: 1rem;
    transition: border-color 0.25s ease, background-color 0.25s ease;
    font-family: var(--fonte-principal);
  }
  input::placeholder, textarea::placeholder {
    color: #bbb;
  }
  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--cor-primaria);
    box-shadow: 0 0 8px var(--cor-primaria);
    background-color: rgba(0, 202, 255, 0.1);
  }
  body.tema-claro input,
  body.tema-claro select,
  body.tema-claro textarea {
    border-color: #aaa;
    background-color: #fff;
    color: var(--cor-claro-texto);
  }
  body.tema-pastel input,
  body.tema-pastel select,
  body.tema-pastel textarea {
    border-color: #b4996f;
    background-color: #8da11b;
    color: var(--cor-pastel-texto);
  }

  /* Bot√µes gerais */
  button {
    cursor: pointer;
    background-color: var(--cor-primaria);
    color: var(--cor-botao-texto);
    border: none;
    border-radius: var(--raio-borda);
    padding: 0.7rem 1.4rem;
    font-weight: 600;
    font-size: 1rem;
    box-shadow: 0 5px 12px rgba(0, 202, 255, 0.35);
    transition: background-color 0.25s ease, box-shadow 0.25s ease, transform 0.1s ease;
    user-select: none;
    display: inline-block;
  }
  button:hover, button:focus {
    background-color: var(--cor-primaria-hover);
    box-shadow: 0 8px 20px rgba(0, 158, 195, 0.6);
  }
  button:active {
    transform: translateY(2px);
    box-shadow: 0 3px 7px rgba(0, 158, 195, 0.9);
  }

  /* Bot√µes pequenos para editar/excluir */
  .btn-small {
    font-size: 0.85rem;
    padding: 0.3rem 0.7rem;
    margin-left: 0.4rem;
    border-radius: 6px;
    user-select: none;
  }
  .btn-edit {
    background-color: #ffcc00;
    color: #222;
    box-shadow: 0 3px 8px #ffcc0090;
  }
  .btn-edit:hover, .btn-edit:focus {
    background-color: #ffbb00;
    box-shadow: 0 5px 14px #ffbb0090;
  }
  .btn-delete {
    background-color: #ff5555;
    color: #fff;
    box-shadow: 0 3px 8px #ff555590;
  }
  .btn-delete:hover, .btn-delete:focus {
    background-color: #ee4444;
    box-shadow: 0 5px 14px #ee444490;
  }

  /* Tabelas */
  table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.95rem;
  }
  th, td {
    padding: 0.4rem 0.7rem;
    border: 1.2px solid #555;
    text-align: left;
  }
  body.tema-claro th, body.tema-claro td {
    border-color: #ddd;
  }
  body.tema-pastel th, body.tema-pastel td {
    border-color: #cea944;
  }

  /* Layouts flex√≠veis */
  .flex-row {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
    align-items: center;
  }
  .flex-grow {
    flex-grow: 1;
  }

  /* Checkbox inline */
  label.checkbox-inline {
    display: flex;
    align-items: center;
    gap: 0.4rem;
    font-size: 1rem;
    user-select: none;
  }

  /* Feedback mensagens */
  .msg-erro {
    color: #ff4444;
    font-weight: 600;
    margin-top: 0.3rem;
  }
  .msg-sucesso {
    color: #4caf50;
    font-weight: 600;
    margin-top: 0.3rem;
  }

  /* √Årea de resultados, logs etc */
  #resultadoDownload, #mensagemUsuario {
    margin-top: 1rem;
    min-height: 1.6em;
    font-weight: 600;
  }
  #resultadoDownload {
    color: var(--cor-primaria);
  }

  /* Rodap√© */
  footer {
    text-align: center;
    margin-top: 2.5rem;
    color: #777;
    font-size: 0.85rem;
    user-select: none;
  }
  footer a {
    color: var(--cor-primaria);
    text-decoration: none;
  }
  footer a:hover, footer a:focus {
    color: var(--cor-primaria-hover);
    text-decoration: underline;
  }
</style>
</head>
<body class="tema-escuro">

<main>
  <h1>üë®‚Äçüè´ CorregePtx‚Ñ¢</h1>
  <p class="subtitulo">Plataforma de Corre√ß√£o para Quem J√° Desistiu de Acreditar.</p>

  <!-- Seletor de Tema -->
  <section aria-label="Configura√ß√µes de Tema">
    <label for="temaSelect" style="font-weight:600;">Escolha o tema:</label>
    <select id="temaSelect" aria-describedby="msgTema" title="Selecione o tema do aplicativo">
      <option value="escuro">Escuro</option>
      <option value="claro">Claro</option>
      <option value="pastel">Pastel</option>
    </select>
    <div id="msgTema" class="msg-sucesso" aria-live="polite" style="margin-top:6px;"></div>
  </section>

  <!-- Se√ß√£o Turmas -->
  <section aria-label="Gerenciar Turmas">
    <h2>Gerenciar Turmas</h2>
    <form id="formAddTurma" aria-describedby="msgTurma" novalidate>
      <label for="inputNomeTurma">Nova turma:</label>
      <input type="text" id="inputNomeTurma" placeholder="Nome da turma" required minlength="2" autocomplete="off" />
      <button type="submit">Adicionar Turma</button>
      <div id="msgTurma" class="msg-erro" aria-live="assertive"></div>
    </form>
    <table id="tabelaTurmas" aria-label="Lista de turmas">
      <thead>
        <tr><th>Turma</th><th>A√ß√µes</th></tr>
      </thead>
      <tbody>
        <!-- Listagem din√¢mica -->
      </tbody>
    </table>
  </section>

  <!-- Se√ß√£o Alunos -->
  <section aria-label="Gerenciar Alunos">
    <h2>Gerenciar Alunos</h2>
    <form id="formAddAluno" aria-describedby="msgAluno" novalidate>
      <label for="selectTurmasForAluno">Selecione a turma:</label>
      <select id="selectTurmasForAluno" required aria-required="true">
        <option value="">-- Selecione uma turma --</option>
      </select>

      <label for="inputNomeAluno">Nome do aluno:</label>
      <input type="text" id="inputNomeAluno" placeholder="Nome do aluno" required minlength="2" autocomplete="off" />
      <button type="submit">Adicionar Aluno</button>
      <div id="msgAluno" class="msg-erro" aria-live="assertive"></div>
    </form>

    <table id="tabelaAlunos" aria-label="Lista de alunos">
      <thead>
        <tr><th>Turma</th><th>Aluno</th><th>A√ß√µes</th></tr>
      </thead>
      <tbody>
        <!-- Listagem din√¢mica -->
      </tbody>
    </table>
  </section>

  <!-- Se√ß√£o Corre√ß√£o de Provas -->
  <section aria-label="Corre√ß√£o Autom√°tica">
    <h2>Corre√ß√£o Autom√°tica</h2>
    <form id="formCorrecao" aria-describedby="msgCorrecao" novalidate>
      <label for="selectTurmasForCorrecao">Selecione a turma:</label>
      <select id="selectTurmasForCorrecao" required aria-required="true">
        <option value="">-- Selecione uma turma --</option>
      </select>

      <label for="selectAlunosForCorrecao">Selecione o aluno:</label>
      <select id="selectAlunosForCorrecao" required aria-required="true">
        <option value="">-- Selecione um aluno --</option>
      </select>

      <label for="inputTextoCorrecao">Cole a resposta para corre√ß√£o:</label>
      <textarea id="inputTextoCorrecao" rows="5" placeholder="Cole o texto da prova aqui..." required minlength="10" spellcheck="true"></textarea>

      <button type="submit">Corrigir Prova</button>
      <div id="msgCorrecao" class="msg-erro" aria-live="assertive"></div>
    </form>

    <div id="resultadoDownload" role="region" aria-live="polite" style="white-space: pre-wrap;"></div>
  </section>
</main>

<footer>
  Desenvolvido por <a href="https://github.com/Ganjabionick8" target="_blank" rel="noopener noreferrer">@Ganjabionick8</a> ‚Äì CorregePtx‚Ñ¢ ¬© 2025
</footer>

<script>
  'use strict';

  // Estado dos dados (turmas e alunos)
  let turmas = JSON.parse(localStorage.getItem('turmas') || '[]');
  let alunos = JSON.parse(localStorage.getItem('alunos') || '[]');

  // Refer√™ncias DOM
  const temaSelect = document.getElementById('temaSelect');
  const msgTema = document.getElementById('msgTema');

  const formAddTurma = document.getElementById('formAddTurma');
  const inputNomeTurma = document.getElementById('inputNomeTurma');
  const msgTurma = document.getElementById('msgTurma');
  const tabelaTurmasBody = document.querySelector('#tabelaTurmas tbody');

  const formAddAluno = document.getElementById('formAddAluno');
  const selectTurmasForAluno = document.getElementById('selectTurmasForAluno');
  const inputNomeAluno = document.getElementById('inputNomeAluno');
  const msgAluno = document.getElementById('msgAluno');
  const tabelaAlunosBody = document.querySelector('#tabelaAlunos tbody');

  const formCorrecao = document.getElementById('formCorrecao');
  const selectTurmasForCorrecao = document.getElementById('selectTurmasForCorrecao');
  const selectAlunosForCorrecao = document.getElementById('selectAlunosForCorrecao');
  const inputTextoCorrecao = document.getElementById('inputTextoCorrecao');
  const msgCorrecao = document.getElementById('msgCorrecao');
  const resultadoDownload = document.getElementById('resultadoDownload');

  // Fun√ß√µes utilit√°rias

  // Salva dados no localStorage
  const salvarDados = () => {
    localStorage.setItem('turmas', JSON.stringify(turmas));
    localStorage.setItem('alunos', JSON.stringify(alunos));
  };

  // Atualiza o tema visual da p√°gina
  const mudarTema = (tema) => {
    document.body.className = '';
    if (['escuro', 'claro', 'pastel'].includes(tema)) {
      document.body.classList.add(`tema-${tema}`);
      localStorage.setItem('temaPreferido', tema);
      msgTema.textContent = `Tema alterado para "${tema}"`;
      setTimeout(() => { msgTema.textContent = ''; }, 2500);
    }
  };

  // Cria elemento option para selects
  const criarOption = (value, text) => {
    const option = document.createElement('option');
    option.value = value;
    option.textContent = text;
    return option;
  };

  // Atualiza selects de turmas
  const atualizarSelectsTurmas = () => {
    // Para alunos e corre√ß√£o
    [selectTurmasForAluno, selectTurmasForCorrecao].forEach(sel => {
      sel.innerHTML = '';
      sel.appendChild(criarOption('', '-- Selecione uma turma --'));
      turmas.forEach(t => sel.appendChild(criarOption(t, t)));
    });
  };

  // Atualiza select de alunos para corre√ß√£o, com base na turma selecionada
  const atualizarSelectAlunosParaCorrecao = () => {
    const turma = selectTurmasForCorrecao.value;
    selectAlunosForCorrecao.innerHTML = '';
    selectAlunosForCorrecao.appendChild(criarOption('', '-- Selecione um aluno --'));
    if (!turma) return;
    alunos.filter(a => a.turma === turma).forEach(a => {
      selectAlunosForCorrecao.appendChild(criarOption(a.nome, a.nome));
    });
  };

  // Renderiza tabelas de turmas e alunos
  const renderizarListas = () => {
    // Turmas
    tabelaTurmasBody.innerHTML = '';
    turmas.forEach((t, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${t}</td>
        <td>
          <button class="btn-small btn-edit" aria-label="Editar turma ${t}" onclick="editarTurma(${i})">&#9998;</button>
          <button class="btn-small btn-delete" aria-label="Excluir turma ${t}" onclick="excluirTurma(${i})">&#10060;</button>
        </td>`;
      tabelaTurmasBody.appendChild(tr);
    });

    // Alunos
    tabelaAlunosBody.innerHTML = '';
    alunos.forEach((a, i) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${a.turma}</td>
        <td>${a.nome}</td>
        <td>
          <button class="btn-small btn-edit" aria-label="Editar aluno ${a.nome}" onclick="editarAluno(${i})">&#9998;</button>
          <button class="btn-small btn-delete" aria-label="Excluir aluno ${a.nome}" onclick="excluirAluno(${i})">&#10060;</button>
        </td>`;
      tabelaAlunosBody.appendChild(tr);
    });
  };

  // Mostrar mensagens tempor√°rias
  const mostrarMensagem = (elemento, msg, tipo = 'erro') => {
    elemento.textContent = msg;
    elemento.className = tipo === 'erro' ? 'msg-erro' : 'msg-sucesso';
    setTimeout(() => {
      elemento.textContent = '';
    }, 3000);
  };

  // === Fun√ß√µes de CRUD para turmas ===

  // Adicionar turma
  formAddTurma.addEventListener('submit', (e) => {
    e.preventDefault();
    const nomeTurma = inputNomeTurma.value.trim();

    if (nomeTurma.length < 2) {
      mostrarMensagem(msgTurma, 'Nome da turma deve ter ao menos 2 caracteres.');
      return;
    }
    if (turmas.includes(nomeTurma)) {
      mostrarMensagem(msgTurma, 'Essa turma j√° existe.');
      return;
    }

    turmas.push(nomeTurma);
    salvarDados();
    atualizarSelectsTurmas();
    renderizarListas();
    inputNomeTurma.value = '';
    mostrarMensagem(msgTurma, `Turma "${nomeTurma}" adicionada com sucesso!`, 'sucesso');
  });

  // Editar turma (prompt simplificado)
  window.editarTurma = (index) => {
    const nomeAtual = turmas[index];
    const novoNome = prompt('Editar nome da turma:', nomeAtual);
    if (!novoNome) return;
    const novoTrim = novoNome.trim();
    if (novoTrim.length < 2) {
      alert('Nome da turma deve ter ao menos 2 caracteres.');
      return;
    }
    if (turmas.includes(novoTrim) && novoTrim !== nomeAtual) {
      alert('J√° existe uma turma com esse nome.');
      return;
    }
    turmas[index] = novoTrim;

    // Atualizar turma dos alunos que pertencem a essa turma
    alunos = alunos.map(a => a.turma === nomeAtual ? {...a, turma: novoTrim} : a);

    salvarDados();
    atualizarSelectsTurmas();
    atualizarSelectAlunosParaCorrecao();
    renderizarListas();
  };

  // Excluir turma (confirma√ß√£o)
  window.excluirTurma = (index) => {
    const nome = turmas[index];
    if (!confirm(`Excluir a turma "${nome}"? Essa a√ß√£o remover√° tamb√©m os alunos dessa turma.`)) return;

    turmas.splice(index, 1);
    // Remover alunos da turma exclu√≠da
    alunos = alunos.filter(a => a.turma !== nome);

    salvarDados();
    atualizarSelectsTurmas();
    atualizarSelectAlunosParaCorrecao();
    renderizarListas();
  };

  // === Fun√ß√µes de CRUD para alunos ===

  // Adicionar aluno
  formAddAluno.addEventListener('submit', (e) => {
    e.preventDefault();
    const turma = selectTurmasForAluno.value;
    const nomeAluno = inputNomeAluno.value.trim();

    if (!turma) {
      mostrarMensagem(msgAluno, 'Selecione uma turma.');
      return;
    }
    if (nomeAluno.length < 2) {
      mostrarMensagem(msgAluno, 'Nome do aluno deve ter ao menos 2 caracteres.');
      return;
    }
    if (alunos.some(a => a.nome === nomeAluno && a.turma === turma)) {
      mostrarMensagem(msgAluno, 'Aluno j√° cadastrado nessa turma.');
      return;
    }

    alunos.push({ turma, nome: nomeAluno });
    salvarDados();
    renderizarListas();
    inputNomeAluno.value = '';
    mostrarMensagem(msgAluno, `Aluno "${nomeAluno}" adicionado √† turma "${turma}"!`, 'sucesso');
  });

  // Editar aluno
  window.editarAluno = (index) => {
    const alunoAtual = alunos[index];
    const novoNome = prompt('Editar nome do aluno:', alunoAtual.nome);
    if (!novoNome) return;
    const novoTrim = novoNome.trim();
    if (novoTrim.length < 2) {
      alert('Nome do aluno deve ter ao menos 2 caracteres.');
      return;
    }
    if (alunos.some((a,i) => i !== index && a.nome === novoTrim && a.turma === alunoAtual.turma)) {
      alert('J√° existe um aluno com esse nome nessa turma.');
      return;
    }
    alunos[index].nome = novoTrim;
    salvarDados();
    renderizarListas();
  };

  // Excluir aluno
  window.excluirAluno = (index) => {
    const nome = alunos[index].nome;
    if (!confirm(`Excluir o aluno "${nome}"?`)) return;
    alunos.splice(index, 1);
    salvarDados();
    renderizarListas();
  };

  // === Fun√ß√£o para corrigir prova ===

  formCorrecao.addEventListener('submit', (e) => {
    e.preventDefault();
    msgCorrecao.textContent = '';
    resultadoDownload.textContent = '';

    const turma = selectTurmasForCorrecao.value;
    const aluno = selectAlunosForCorrecao.value;
    const texto = inputTextoCorrecao.value.trim();

    if (!turma) {
      mostrarMensagem(msgCorrecao, 'Selecione uma turma.');
      return;
    }
    if (!aluno) {
      mostrarMensagem(msgCorrecao, 'Selecione um aluno.');
      return;
    }
    if (texto.length < 10) {
      mostrarMensagem(msgCorrecao, 'Insira o texto da prova para corre√ß√£o.');
      return;
    }

    // Simples corre√ß√£o: conta quantas vezes palavras-chave aparecem (exemplo)
    // Voc√™ pode customizar essas palavras para o seu uso
    const palavrasChave = ['resposta', 'correta', 'exemplo', 'importante'];
    const textoMinusculo = texto.toLowerCase();

    let acertos = 0;
    palavrasChave.forEach(p => {
      if (textoMinusculo.includes(p)) acertos++;
    });

    const total = palavrasChave.length;
    const nota = ((acertos / total) * 10).toFixed(1);

    resultadoDownload.textContent = 
      `Aluno: ${aluno}\nTurma: ${turma}\nNota: ${nota} / 10\n\n` + 
      `Palavras-chave encontradas: ${acertos} de ${total}\n\n` +
      `Texto enviado:\n${texto}`;

    mostrarMensagem(msgCorrecao, 'Corre√ß√£o conclu√≠da!', 'sucesso');
  });

  // Inicializa√ß√£o ao carregar a p√°gina
  window.addEventListener('load', () => {
    // Tema salvo no localStorage
    const temaSalvo = localStorage.getItem('temaPreferido') || 'escuro';
    temaSelect.value = temaSalvo;
    mudarTema(temaSalvo);

    atualizarSelectsTurmas();
    atualizarSelectAlunosParaCorrecao();
    renderizarListas();
  });

  // Atualiza alunos ao mudar turma na corre√ß√£o
  selectTurmasForCorrecao.addEventListener('change', atualizarSelectAlunosParaCorrecao);

  // Mudar tema ao selecionar
  temaSelect.addEventListener('change', () => mudarTema(temaSelect.value));
</script>

</body>
</html>
