<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>CorregePtx</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
:root {
  --cor-primaria: #4caf50;
  --cor-secundaria: #2196f3;
  --fundo-claro: #f9f9f9;
  --texto-claro: #222;
  --fundo-escuro: #121212;
  --texto-escuro: #e0e0e0;
  --input-bg-claro: #fff;
  --input-bg-escuro: #1e1e1e;
}
body { font-family: 'Roboto', sans-serif; background: var(--fundo-claro); color: var(--texto-claro); padding: 20px; max-width: 700px; margin: auto; transition: all 0.3s; }
body.dark { background: var(--fundo-escuro); color: var(--texto-escuro); }
h1 { color: var(--cor-primaria); text-align: center; }
label { display: block; margin-top: 15px; font-weight: bold; }
input, textarea, select { width: 100%; padding: 8px; margin-top: 5px; border-radius: 6px; border: 1px solid #ccc; background: var(--input-bg-claro); color: var(--texto-claro); }
body.dark input, body.dark textarea, body.dark select { background: var(--input-bg-escuro); color: var(--texto-escuro); border: 1px solid #555; }
button { margin-top: 15px; padding: 10px; width: 100%; border: none; border-radius: 6px; background: var(--cor-primaria); color: #fff; font-weight: bold; cursor: pointer; }
button:hover { background: var(--cor-secundaria); }
.item-group { margin-top: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 8px; }
.total { font-size: 1.5rem; font-weight: bold; margin-top: 20px; text-align: center; color: var(--cor-primaria); }
.footer { margin-top: 40px; font-size: 0.9rem; text-align: center; color: #666; }
.footer a { color: var(--cor-primaria); text-decoration: none; margin: 0 5px; }
.tema-toggle { position: fixed; top: 18px; right: 18px; background: var(--cor-primaria); border: none; border-radius: 20px; width: 50px; height: 26px; cursor: pointer; }
.tema-toggle:before { content: ""; position: absolute; top: 3px; left: 3px; width: 20px; height: 20px; background: #fff; border-radius: 50%; transition: transform 0.3s ease; }
body.dark .tema-toggle { background: var(--cor-secundaria); }
body.dark .tema-toggle:before { transform: translateX(24px); }
.remove-btn { background:#ff4d4d; color:#fff; border:none; border-radius:50%; width:24px;height:24px; cursor:pointer; float:right; }
.remove-btn:hover { background:#ff1a1a; }
</style>
</head>
<body>

<button class="tema-toggle" aria-label="Alternar tema"></button>

<h1>CorregePtx</h1>

<label for="aluno">Nome do Aluno</label>
<input type="text" id="aluno" placeholder="Digite o nome do aluno">

<label for="turma">Turma</label>
<input type="text" id="turma" placeholder="Digite a turma">

<div class="item-group" aria-label="Quest√µes Objetivas">
  <h2>Prova Objetiva</h2>
  <div id="questoesContainer"></div>
  <button type="button" onclick="adicionarQuestao()">+ Adicionar Quest√£o</button>
</div>

<div class="item-group">
  <h2>Prova Dissertativa</h2>
  <label for="dissertativa">Resposta (palavra-chave)</label>
  <textarea id="dissertativa" rows="4" placeholder="Digite a resposta do aluno"></textarea>
</div>

<div class="total" id="notaTotal">Nota: 0</div>

<button onclick="calcularNota()">Calcular Nota</button>
<button onclick="gerarPDF()">üßæ Gerar PDF</button>
<button onclick="limparTudo()">üßπ Limpar Tudo</button>

<div class="item-group">
  <h2>Hist√≥rico de Alunos</h2>
  <ul id="historicoAlunos"></ul>
</div>

<div class="footer">
  Feito por Ganjabionick8 ‚Ä¢ Apoie este projeto ‚ù§Ô∏è<br>
  <a href="https://instagram.com/Ganjabionick8" target="_blank">Instagram</a> | 
  <a href="https://github.com/Ganjabionick8" target="_blank">GitHub</a>
</div>

<script>
const temaToggle = document.querySelector('.tema-toggle');
temaToggle.addEventListener('click',()=>{
  document.body.classList.toggle('dark');
  localStorage.setItem('temaCorrege', document.body.classList.contains('dark')?'dark':'light');
});
window.onload=()=>{ 
  if(localStorage.getItem('temaCorrege')==='dark') document.body.classList.add('dark');
  carregarHistorico();
};

let questoes = [];

function adicionarQuestao(pergunta='', resposta=''){
  const container = document.getElementById('questoesContainer');
  const index = questoes.length;
  const div = document.createElement('div');
  div.classList.add('item-row');
  div.innerHTML=`
    <button class="remove-btn" onclick="removerQuestao(${index})" title="Remover">√ó</button>
    <label>Pergunta ${index+1}</label>
    <input type="text" value="${pergunta}" placeholder="Digite a quest√£o">
    <label>Resposta Correta</label>
    <input type="text" value="${resposta}" placeholder="Digite a resposta correta">
    <hr>
  `;
  container.appendChild(div);
  questoes.push(index);
}

function removerQuestao(i){
  document.getElementById('questoesContainer').children[i].remove();
  questoes.splice(i,1);
}

function calcularNota(){
  let nota = 0;
  const container = document.getElementById('questoesContainer');
  for(let i=0;i<container.children.length;i++){
    const inputs = container.children[i].querySelectorAll('input');
    if(inputs[0].value.trim().toLowerCase() === inputs[1].value.trim().toLowerCase()) nota += 5;
  }
  const dissertativa = document.getElementById('dissertativa').value.toLowerCase();
  if(dissertativa.includes('html')) nota += 5;

  document.getElementById('notaTotal').innerText=`Nota: ${nota}`;
  salvarHistorico(nota);
}

function gerarPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  let y=10;
  const aluno=document.getElementById('aluno').value||'N/A';
  const turma=document.getElementById('turma').value||'N/A';
  const nota=document.getElementById('notaTotal').innerText;
  doc.setFontSize(16); doc.text("CorregePtx",10,y); y+=10;
  doc.setFontSize(12); doc.text(`Aluno: ${aluno}`,10,y); y+=7;
  doc.text(`Turma: ${turma}`,10,y); y+=10;
  doc.text("Prova Objetiva:",10,y); y+=7;
  const container = document.getElementById('questoesContainer');
  for(let i=0;i<container.children.length;i++){
    const inputs = container.children[i].querySelectorAll('input');
    doc.text(`Q${i+1}: ${inputs[0].value} | Resposta: ${inputs[1].value}`,10,y); y+=6;
  }
  doc.text("Prova Dissertativa:",10,y); y+=7;
  doc.text(document.getElementById('dissertativa').value||'N/A',10,y); y+=10;
  doc.text(nota,10,y);
  doc.save("correcao.pdf");
}

function limparTudo(){
  if(confirm("Limpar todos os campos?")){
    document.getElementById('aluno').value='';
    document.getElementById('turma').value='';
    document.getElementById('dissertativa').value='';
    document.getElementById('notaTotal').innerText='Nota: 0';
    document.getElementById('questoesContainer').innerHTML='';
    questoes=[];
  }
}

function salvarHistorico(nota){
  const aluno=document.getElementById('aluno').value||'N/A';
  const turma=document.getElementById('turma').value||'N/A';
  const historico = JSON.parse(localStorage.getItem('historicoAlunos')||'[]');
  historico.unshift({aluno,turma,nota});
  if(historico.length>10) historico.pop();
  localStorage.setItem('historicoAlunos',JSON.stringify(historico));
  carregarHistorico();
}

function carregarHistorico(){
  const lista=document.getElementById('historicoAlunos');
  lista.innerHTML='';
  const historico = JSON.parse(localStorage.getItem('historicoAlunos')||'[]');
  historico.forEach(item=>{
    const li=document.createElement('li');
    li.innerText=`${item.aluno} (${item.turma}): ${item.nota}`;
    lista.appendChild(li);
  });
}
</script>

</body>
</html>
